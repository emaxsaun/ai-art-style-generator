<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Photobooth app to upload photos, choose styles and models, and generate stylized images."><meta name="keywords" content="photobooth, photo upload, photo styles, AI photo generation, image filter"><title>Photobooth</title><style>@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap);body,html{margin:0;padding:0}body{background:linear-gradient(135deg,#6b73ff 0,#000dff 100%);font-family:Poppins,Arial,sans-serif;min-height:100vh}#box{background:rgba(255,255,255,.1);backdrop-filter:blur(8px);max-width:600px;margin:50px auto;text-align:center;padding:30px;border-radius:16px;color:#fff;box-shadow:0 8px 24px rgba(0,0,0,.3)}h1{font-weight:600;font-size:2.5rem;margin-bottom:25px;text-shadow:0 2px 8px rgba(0,0,0,.3)}form{margin-bottom:30px;font-weight:700}.file-upload-wrapper{display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;margin-bottom:20px}#drop-area{border:2px dashed #fff;border-radius:12px;padding:20px;text-align:center;color:#fff;font-weight:600;margin-bottom:20px;transition:background .3s ease}#drop-area.dragover{background:rgba(255,255,255,.1)}#camera-modal{margin-top:20px;display:flex;flex-direction:column;align-items:center;gap:12px}#camera-stream{max-width:512px;width:100%;height:auto}#camera-modal.hidden{display:none}canvas,video{max-width:100%;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,.3)}.hidden{display:none!important}canvas.hidden{display:block;opacity:0;max-width:100px;transition:opacity .3s ease}canvas.show-preview{opacity:1}input[type=file]{display:none}.custom-file-label{background-color:#fff;color:#333;padding:10px 20px;border-radius:10px;font-weight:600;cursor:pointer;box-shadow:0 2px 10px rgba(0,0,0,.2);border:1px solid #eee;transition:background .3s}.custom-file-label:hover{background-color:#eee}#filename-display{color:#fff;font-size:1rem;text-shadow:0 1px 3px rgba(0,0,0,.3)}button{background:#ff7e5f;color:#fff;border:none;padding:15px 36px;border-radius:12px;font-weight:600;font-size:1.2rem;cursor:pointer;box-shadow:0 4px 15px rgba(255,126,95,.6);transition:background .3s ease}button:hover{background:#ff4b2b;box-shadow:0 6px 20px rgba(255,75,43,.7)}#result-img{max-width:100%;margin:20px auto 0;border-radius:16px;box-shadow:0 6px 16px rgba(0,0,0,.4);display:none;border:4px solid #fff}#style-display{font-weight:600;margin-top:20px;font-size:1.25rem;min-height:28px;color:gold;text-shadow:0 1px 4px rgba(0,0,0,.5)}#error-message{color:#ff6b6b;margin-top:20px;font-weight:700;font-size:1.1rem;display:none;text-shadow:0 1px 3px rgba(0,0,0,.3);text-transform:uppercase}#loading-spinner{display:none;margin:30px auto 0;width:48px;height:48px;border:5px solid rgba(255,255,255,.3);border-top:5px solid #fff;border-radius:50%;animation:spin 1s linear infinite}#toggle-camera{display:inline-block}@media (min-width:768px){#toggle-camera{display:none}}#camera-buttons button{display:block;width:100%;margin-bottom:10px}label{font-weight:600;color:#fff;display:block;margin-bottom:8px;font-size:1.1rem;text-shadow:0 1px 3px rgba(0,0,0,.3)}#model-select,#style-select{width:100%;padding:12px 16px;border-radius:12px;border:none;font-size:1.1rem;font-weight:600;background-color:rgba(255 255 255 / .9);color:#333;box-shadow:0 4px 12px rgba(0,0,0,.15);transition:background-color .3s ease,box-shadow .3s ease;cursor:pointer}#model-select:focus,#model-select:hover,#style-select:focus,#style-select:hover{background-color:#fff;box-shadow:0 6px 20px rgba(0,0,0,.25);outline:0}#custom-prompt{width:100%;padding:12px 16px;border-radius:12px;border:none;font-size:1.1rem;font-weight:600;background-color:rgba(255 255 255 / .9);color:#333;box-shadow:0 4px 12px rgba(0,0,0,.15);transition:background-color .3s ease,box-shadow .3s ease;resize:vertical}#custom-prompt:focus{background-color:#fff;box-shadow:0 6px 20px rgba(0,0,0,.25);outline:0}#custom-prompt:disabled{background-color:rgba(255,255,255,.5);border:1px solid #ff6b6b!important;cursor:not-allowed}.mirror-preview{transform:scaleX(-1)}button:disabled{opacity:.6;cursor:not-allowed}#image-url{width:100%;padding:12px 16px;border-radius:12px;border:none;font-size:1.1rem;font-weight:600;background-color:rgba(255,255,255,.9);color:#333;box-shadow:0 4px 12px rgba(0,0,0,.15);margin-top:8px;box-sizing:border-box}@keyframes spin{to{transform:rotate(360deg)}}</style></head><body><div id="box"><h1>Photobooth</h1><h2>Upload Your Photo</h2><form id="upload-form" enctype="multipart/form-data"><div class="file-upload-wrapper"><label for="photo" class="custom-file-label">Choose File</label> <input type="file" name="photo" id="photo" accept="image/*"> <button id="open-camera" type="button" style="padding:12px 36px;margin-top:-8px">üì∑ Use Camera</button><div id="camera-modal" class="hidden"><video id="camera-stream" autoplay playsinline></video><button id="take-photo" type="button">Take Photo</button> <button id="toggle-camera" type="button">üîÑ Switch Camera</button><canvas id="snapshot" class="hidden"></canvas><div id="camera-buttons"><button id="close-camera" type="button">Cancel</button></div></div><span id="filename-display">No file chosen</span></div><div id="drop-area"><p>Or drag and drop an image here</p></div><div id="url-upload-wrapper" style="margin-top:12px"><div style="margin-bottom:16px"><label for="image-url" style="color:#fff">Or enter an image URL / Paste an image:</label> <input type="url" id="image-url" name="image-url" placeholder="Enter an image URL / Paste an image"></div></div><div style="margin-bottom:16px"><div><label for="model-select" style="color:#fff">Choose a model:</label> <select name="model" id="model-select"><option value="pulid" selected="selected">PuLID (Default)</option><option value="photomaker">PhotoMaker</option><option value="fofr">Face to Many</option></select></div><div style="margin-bottom:20px"><label for="style-select" style="color:#fff">Choose a style:</label> <select id="style-select" name="style"></select></div></div><div style="margin-bottom:16px"><label for="custom-prompt" style="color:#fff">Custom prompt:<div style="font-size:14px;text-transform:uppercase;margin-bottom:6px">Note - The word "img" must be included for the PhotoMaker model</div><div style="font-size:14px;text-transform:uppercase">Note - The custom prompt is disabled for the Face to Many model</div></label> <textarea id="custom-prompt" name="prompt" rows="4" style="width:97%;padding:8px;border-radius:8px;border:none;margin-bottom:24px"></textarea> <button id="randomize-style" type="button" style="background:#4caf50;box-shadow:0 4px 15px rgba(76,175,80,.6)">üîÄ Randomize Style</button></div><button type="submit" style="width:250px">Generate Photo</button></form><div id="style-display"></div><img id="result-img" alt="Generated Photo"><div id="loading-spinner"></div><progress id="progress-bar" value="0" max="100" style="width:100%;display:none"></progress><div id="progress-text" style="color:#fff;font-weight:700;margin-top:8px;display:none">0%</div><div id="error-message"></div></div><script>let photoTaken=!1,stylesList=[];const styleSelect=document.getElementById("style-select"),customPromptInput=document.getElementById("custom-prompt");async function initializeStyles(){const e=await fetch("/styles"),t=await e.json();stylesList=t;const a=t[Math.floor(Math.random()*t.length)],n=a.prompt;t.forEach(e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,styleSelect.appendChild(t)}),styleSelect.value=a.name,customPromptInput.value=n,styleSelect.addEventListener("change",()=>{const e=modelSelect.value,a=styleSelect.value;"fofr"===e&&(customPromptInput.value=`A portrait img in the style of ${a}`);const n=t.find(e=>e.name===a);n&&(customPromptInput.value=n.prompt)})}initializeStyles();const fofrStyles=["3D","Emoji","Video game","Pixels","Clay","Toy"],modelSelect=document.getElementById("model-select");modelSelect.addEventListener("change",()=>{if("fofr"===modelSelect.value){const e=fofrStyles[Math.floor(Math.random()*fofrStyles.length)];styleSelect.innerHTML="",fofrStyles.forEach(e=>{const t=document.createElement("option");t.value=e,t.textContent=e,styleSelect.appendChild(t)}),styleSelect.value=e,customPromptInput.value=`A portrait img in the style of ${e}`,customPromptInput.disabled=!0,customPromptInput.style.opacity="0.6"}else{const e=styleSelect.value;styleSelect.innerHTML="",stylesList.forEach(e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,styleSelect.appendChild(t)});const t=stylesList[0].name,a=stylesList.find(t=>t.name===e);styleSelect.value=a?e:t;const n=stylesList.find(e=>e.name===styleSelect.value);customPromptInput.value=n?n.prompt:"",customPromptInput.disabled=!1,customPromptInput.style.opacity="1"}});const form=document.getElementById("upload-form"),resultImg=document.getElementById("result-img"),styleDisplay=document.getElementById("style-display"),errorMessage=document.getElementById("error-message"),loadingSpinner=document.getElementById("loading-spinner"),fileInput=document.getElementById("photo"),filenameDisplay=document.getElementById("filename-display");fileInput.addEventListener("change",()=>{filenameDisplay.textContent=fileInput.files.length>0?fileInput.files[0].name:"No file chosen";const e=document.getElementById("image-url");e&&(e.value="")});const imageUrlInput=document.getElementById("image-url");imageUrlInput.addEventListener("input",()=>{if(imageUrlInput.value.trim()){const e=imageUrlInput.value.trim().split("/").pop().split("?")[0];filenameDisplay.textContent=e||"URL image selected"}else filenameDisplay.textContent="No file chosen"});const dropArea=document.getElementById("drop-area");function updateDragDropVisibility(){window.innerWidth<768?dropArea.style.display="none":dropArea.style.display="block"}updateDragDropVisibility(),window.addEventListener("resize",()=>{countdownOverlay.classList.contains("hidden")||positionCountdownOverlay()}),window.addEventListener("resize",updateDragDropVisibility),["dragenter","dragover"].forEach(e=>{dropArea.addEventListener(e,e=>{e.preventDefault(),e.stopPropagation(),dropArea.classList.add("dragover")})}),["dragleave","drop"].forEach(e=>{dropArea.addEventListener(e,e=>{e.preventDefault(),e.stopPropagation(),dropArea.classList.remove("dragover")})}),dropArea.addEventListener("drop",e=>{const t=e.dataTransfer.files;t.length>0&&t[0].type.startsWith("image/")&&(fileInput.files=t,filenameDisplay.textContent=t[0].name)});const openCameraBtn=document.getElementById("open-camera"),toggleCameraBtn=document.getElementById("toggle-camera"),cameraModal=document.getElementById("camera-modal"),cameraStreamElem=document.getElementById("camera-stream"),takePhotoBtn=document.getElementById("take-photo"),snapshotCanvas=document.getElementById("snapshot"),closeCameraBtn=document.getElementById("close-camera");let cameraStream,countdownInterval,countdownNumber,useFrontCamera=!0;const ctx=snapshotCanvas.getContext("2d");async function startCamera(){const e=useFrontCamera?"user":"environment";try{cameraStream=await navigator.mediaDevices.getUserMedia({video:{facingMode:e}}),cameraStreamElem.srcObject=cameraStream,useFrontCamera?cameraStreamElem.classList.add("mirror-preview"):cameraStreamElem.classList.remove("mirror-preview")}catch(e){console.log("Could not access camera: "+e.message),cameraModal.classList.add("hidden")}}function updateToggleCameraVisibility(){const e=window.innerWidth<768,t=!cameraModal.classList.contains("hidden");toggleCameraBtn.style.display=t&&!photoTaken&&e?"inline-block":"none"}function stopCamera(){cameraStream&&(cameraStream.getTracks().forEach(e=>e.stop()),cameraStream=null)}updateToggleCameraVisibility(),window.addEventListener("resize",updateToggleCameraVisibility),openCameraBtn.addEventListener("click",async()=>{photoTaken=!1,cameraModal.classList.remove("hidden"),snapshotCanvas.classList.add("hidden"),cameraStreamElem.style.display="block",takePhotoBtn.style.display="inline-block",window.innerWidth<768?toggleCameraBtn.style.display="inline-block":toggleCameraBtn.style.display="none",countdownOverlay.style.display="none",retakeBtn&&retakeBtn.remove(),await startCamera(),positionCountdownOverlay(),updateToggleCameraVisibility()}),toggleCameraBtn.addEventListener("click",async()=>{useFrontCamera=!useFrontCamera,stopCamera(),await startCamera(),positionCountdownOverlay()}),closeCameraBtn.addEventListener("click",()=>{stopCamera(),cameraModal.classList.add("hidden"),clearCountdown(),snapshotCanvas.classList.add("hidden"),cameraStreamElem.style.display="block",takePhotoBtn.style.display="inline-block",countdownOverlay.style.display="none",retakeBtn&&retakeBtn.remove(),fileInput.value="",filenameDisplay.textContent="No file chosen",updateToggleCameraVisibility(),photoTaken=!1,openCameraBtn.disabled=!1});const countdownOverlay=document.createElement("div");function clearCountdown(){clearInterval(countdownInterval),countdownOverlay.style.display="none"}let retakeBtn;function createRetakeButton(){retakeBtn=document.createElement("button"),retakeBtn.textContent="Retake",retakeBtn.type="button",retakeBtn.style.marginBottom="8px",retakeBtn.style.background="#555",retakeBtn.style.color="white",retakeBtn.style.border="none",retakeBtn.style.padding="10px 20px",retakeBtn.style.borderRadius="10px",retakeBtn.style.cursor="pointer";document.getElementById("camera-buttons").insertBefore(retakeBtn,closeCameraBtn),retakeBtn.addEventListener("click",async()=>{retakeBtn.disabled=!0,snapshotCanvas.classList.add("hidden"),retakeBtn.remove(),photoTaken=!1,takePhotoBtn.style.display="inline-block",window.innerWidth<768?toggleCameraBtn.style.display="inline-block":toggleCameraBtn.style.display="none",countdownOverlay.style.display="none",cameraStreamElem.style.display="block",fileInput.value="",filenameDisplay.textContent="No file chosen";try{stopCamera(),await startCamera(),positionCountdownOverlay()}catch(e){console.error("Failed to restart camera:",e),alert("Could not access the camera. Please try again."),retakeBtn.disabled=!1}setTimeout(updateToggleCameraVisibility,10)})}function positionCountdownOverlay(){const e=cameraModal.getBoundingClientRect(),t=cameraStreamElem.getBoundingClientRect(),a=t.top-e.top,n=t.left-e.left;countdownOverlay.style.position="absolute",countdownOverlay.style.top=a+"px",countdownOverlay.style.left=n+"px",countdownOverlay.style.width=t.width+"px",countdownOverlay.style.height=t.height+"px"}countdownOverlay.style.position="absolute",countdownOverlay.style.top=0,countdownOverlay.style.left=0,countdownOverlay.style.right=0,countdownOverlay.style.bottom="74px",countdownOverlay.style.display="flex",countdownOverlay.style.alignItems="center",countdownOverlay.style.justifyContent="center",countdownOverlay.style.fontSize="6rem",countdownOverlay.style.color="white",countdownOverlay.style.textShadow="0 0 10px black",countdownOverlay.style.backgroundColor="rgba(0,0,0,0.5)",countdownOverlay.style.zIndex=10,countdownOverlay.style.borderRadius="12px",countdownOverlay.style.userSelect="none",countdownOverlay.style.pointerEvents="none",countdownOverlay.style.display="none",cameraModal.style.position="relative",cameraModal.appendChild(countdownOverlay),takePhotoBtn.addEventListener("click",()=>{const e=document.getElementById("image-url");e&&(e.value=""),countdownNumber=3,countdownOverlay.textContent=countdownNumber,positionCountdownOverlay(),countdownOverlay.style.display="flex",openCameraBtn.disabled=!0,takePhotoBtn.style.display="none",toggleCameraBtn.style.display="none",cameraStreamElem.style.display="block",countdownInterval=setInterval(()=>{if(countdownNumber--,0===countdownNumber){clearCountdown(),openCameraBtn.disabled=!1;const e=512,t=cameraStreamElem.videoWidth,a=cameraStreamElem.videoHeight,n=e/t;snapshotCanvas.width=e,snapshotCanvas.height=a*n,useFrontCamera?(ctx.save(),ctx.translate(snapshotCanvas.width,0),ctx.scale(-1,1),ctx.drawImage(cameraStreamElem,0,0,snapshotCanvas.width,snapshotCanvas.height),ctx.restore()):ctx.drawImage(cameraStreamElem,0,0,snapshotCanvas.width,snapshotCanvas.height),photoTaken=!0,snapshotCanvas.toBlob(e=>{if(!e)return void console.error("No blob returned from canvas.");const t=new File([e],"captured-photo.png",{type:"image/png"}),a=new DataTransfer;a.items.add(t),fileInput.files=a.files,filenameDisplay.textContent=t.name;const n=document.getElementById("image-url");n&&(n.value="")},"image/png"),setTimeout(()=>{cameraStreamElem.style.display="none",toggleCameraBtn.style.display="none",snapshotCanvas.classList.remove("hidden"),createRetakeButton(),setTimeout(updateToggleCameraVisibility,50)},100)}else countdownOverlay.textContent=countdownNumber},1e3)}),form.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("image-url"),a=t?.value.trim();if(!(fileInput.files&&0!==fileInput.files.length||a))return errorMessage.textContent="Please upload a file or enter an image URL before generating.",void(errorMessage.style.display="block");console.log("Submitting file:",fileInput.files[0]),errorMessage.style.display="none",styleDisplay.textContent="",resultImg.style.display="none",loadingSpinner.style.display="inline-block";const n=document.getElementById("progress-bar"),o=document.getElementById("progress-text");n.style.display="block",o.style.display="block",n.value=0,o.textContent="0%";const l=Date.now(),s=setInterval(()=>{const e=Date.now()-l,t=Math.min(100,Math.floor(e/1e4*100));n.value=t,o.textContent=`${t}%`,t>=100&&clearInterval(s)},200),r=new FormData,i=document.getElementById("image-url").value.trim();i?r.append("imageUrl",i):r.append("photo",fileInput.files[0]),r.append("selectedStyle",styleSelect.value),r.append("customPrompt",customPromptInput.value),r.append("model",document.getElementById("model-select").value);try{const e=await fetch("/upload",{method:"POST",body:r}),t=await e.json();if(loadingSpinner.style.display="none",clearInterval(s),n.style.display="none",o.style.display="none",console.log("Response data:",t),"string"==typeof t.imageUrl&&t.imageUrl.trim().length>0){console.log("Setting image src to:",t.imageUrl),styleDisplay.textContent=`Style applied: ${t.message.replace("Image processed in ","")}`,resultImg.src=t.imageUrl,resultImg.style.display="block";const e=t.message.replace("Image processed in ",""),a=stylesList.find(t=>t.name===e),n=a?a.prompt:"",o=customPromptInput.value.trim();styleDisplay.textContent=o&&o!==n?"Custom prompt applied":`Style applied: ${e}`}else console.error("Invalid imageUrl:",t.imageUrl),errorMessage.textContent="Received invalid image URL.",errorMessage.style.display="block"}catch(e){loadingSpinner.style.display="none",clearInterval(s),n.style.display="none",o.style.display="none",errorMessage.textContent="An error occurred. Please try again.",errorMessage.style.display="block",console.error(e)}});const randomizeBtn=document.getElementById("randomize-style");randomizeBtn.addEventListener("click",()=>{if("fofr"===modelSelect.value){const e=fofrStyles[Math.floor(Math.random()*fofrStyles.length)];styleSelect.value=e,customPromptInput.value=`A portrait img in the style of ${e}`}else{if(!stylesList||0===stylesList.length)return;const e=stylesList[Math.floor(Math.random()*stylesList.length)];styleSelect.value=e.name,customPromptInput.value=e.prompt,styleDisplay.textContent=""}});const promptTextarea=document.getElementById("custom-prompt");promptTextarea.addEventListener("input",()=>{promptTextarea.style.height="auto",promptTextarea.style.height=promptTextarea.scrollHeight+"px"}),window.addEventListener("load",()=>{promptTextarea.style.height="auto",promptTextarea.style.height=promptTextarea.scrollHeight+"px"}),document.addEventListener("paste",async e=>{const t=e.clipboardData?.items;if(t)for(let e=0;e<t.length;e++){const a=t[e];if("file"===a.kind&&a.type.startsWith("image/")){const e=a.getAsFile();if(e){const t=new DataTransfer;t.items.add(e),fileInput.files=t.files;const a=document.getElementById("image-url");a&&(a.value=""),filenameDisplay.textContent=e.name||"Pasted image",console.log("üìã Image pasted from clipboard:",e)}}}})</script><footer style="text-align:center;margin-top:40px;color:#fff;font-size:.9rem"><p><a href="https://github.com/emaxsaun/ai-art-style-generator" target="_blank" style="color:#ccc;text-decoration:none">‚≠ê View the source on GitHub</a></p></footer></body></html>